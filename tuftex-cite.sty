\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tuftex-cite}[2023-06-20 package tuftex-cite]

% package preliminary declarations
% although this should already be loaded by tufte2-sidenotes
% let's be explicit about our dependencies shall we? 
\RequirePackage{sidenotes} 
\RequirePackage{pgffor} % to use \foreach
\RequirePackage[round]{natbib} % natbib
\RequirePackage{bibentry}
\nobibliography* % do this so i can later use bibentries

% package options: none so far

% other package declarations
\ProvideDocumentCommand{\doi}{m}{\textsc{doi:} #1}

% redefine cite to call sidenote
\RenewDocumentCommand{\cite}{m}{%
\nocite{#1}%
\sidenote{\raggedright\foreach [count=\ni] \entry in {#1}
{\ifnum\ni=1%
\bibentry{\entry}%
\else%
; \bibentry{\entry}%
\fi}} %\sidenote
} %\cite

% TODO 
% fix spacing
% also entry1; entry2; and entry3 % probably wontfix

